
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Async wrapper in python for the spotify api">
      
      
      
      
        <link rel="canonical" href="https://huiibuh.github.io/AsyncSpotify/EXAMPLES/">
      
      <link rel="shortcut icon" href="https://upload.wikimedia.org/wikipedia/commons/9/9b/Font_Awesome_5_brands_spotify.svg">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-6.2.4">
    
    
      
        <title>Examples - Async Spotify</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="green" data-md-color-accent="green">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://huiibuh.github.io/AsyncSpotify/" title="Async Spotify" class="md-header-nav__button md-logo" aria-label="Async Spotify">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.9 10.9C14.7 9 9.35 8.8 6.3 9.75c-.5.15-1-.15-1.15-.6-.15-.5.15-1 .6-1.15 3.55-1.05 9.4-.85 13.1 1.35.45.25.6.85.35 1.3-.25.35-.85.5-1.3.25m-.1 2.8c-.25.35-.7.5-1.05.25-2.7-1.65-6.8-2.15-9.95-1.15-.4.1-.85-.1-.95-.5-.1-.4.1-.85.5-.95 3.65-1.1 8.15-.55 11.25 1.35.3.15.45.65.2 1m-1.2 2.75c-.2.3-.55.4-.85.2-2.35-1.45-5.3-1.75-8.8-.95-.35.1-.65-.15-.75-.45-.1-.35.15-.65.45-.75 3.8-.85 7.1-.5 9.7 1.1.35.15.4.55.25.85M12 2A10 10 0 002 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Async Spotify
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Examples
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/HuiiBuh/AsyncSpotify/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2.6 10.59L8.38 4.8l1.69 1.7c-.24.85.15 1.78.93 2.23v5.54c-.6.34-1 .99-1 1.73a2 2 0 002 2 2 2 0 002-2c0-.74-.4-1.39-1-1.73V9.41l2.07 2.09c-.07.15-.07.32-.07.5a2 2 0 002 2 2 2 0 002-2 2 2 0 00-2-2c-.18 0-.35 0-.5.07L13.93 7.5a1.98 1.98 0 00-1.15-2.34c-.43-.16-.88-.2-1.28-.09L9.8 3.38l.79-.78c.78-.79 2.04-.79 2.82 0l7.99 7.99c.79.78.79 2.04 0 2.82l-7.99 7.99c-.78.79-2.04.79-2.82 0L2.6 13.41c-.79-.78-.79-2.04 0-2.82z"/></svg>
  </div>
  <div class="md-source__repository">
    HuiiBuh/AsyncSpotify
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://huiibuh.github.io/AsyncSpotify/" title="Async Spotify" class="md-nav__button md-logo" aria-label="Async Spotify">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.9 10.9C14.7 9 9.35 8.8 6.3 9.75c-.5.15-1-.15-1.15-.6-.15-.5.15-1 .6-1.15 3.55-1.05 9.4-.85 13.1 1.35.45.25.6.85.35 1.3-.25.35-.85.5-1.3.25m-.1 2.8c-.25.35-.7.5-1.05.25-2.7-1.65-6.8-2.15-9.95-1.15-.4.1-.85-.1-.95-.5-.1-.4.1-.85.5-.95 3.65-1.1 8.15-.55 11.25 1.35.3.15.45.65.2 1m-1.2 2.75c-.2.3-.55.4-.85.2-2.35-1.45-5.3-1.75-8.8-.95-.35.1-.65-.15-.75-.45-.1-.35.15-.65.45-.75 3.8-.85 7.1-.5 9.7 1.1.35.15.4.55.25.85M12 2A10 10 0 002 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"/></svg>

    </a>
    Async Spotify
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/HuiiBuh/AsyncSpotify/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2.6 10.59L8.38 4.8l1.69 1.7c-.24.85.15 1.78.93 2.23v5.54c-.6.34-1 .99-1 1.73a2 2 0 002 2 2 2 0 002-2c0-.74-.4-1.39-1-1.73V9.41l2.07 2.09c-.07.15-.07.32-.07.5a2 2 0 002 2 2 2 0 002-2 2 2 0 00-2-2c-.18 0-.35 0-.5.07L13.93 7.5a1.98 1.98 0 00-1.15-2.34c-.43-.16-.88-.2-1.28-.09L9.8 3.38l.79-.78c.78-.79 2.04-.79 2.82 0l7.99 7.99c.79.78.79 2.04 0 2.82l-7.99 7.99c-.78.79-2.04.79-2.82 0L2.6 13.41c-.79-.78-.79-2.04 0-2.82z"/></svg>
  </div>
  <div class="md-source__repository">
    HuiiBuh/AsyncSpotify
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Examples
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav" aria-label="Getting started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorization-code-flow" class="md-nav__link">
    Authorization Code Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-flow" class="md-nav__link">
    Client Credentials Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints" class="md-nav__link">
    Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" class="md-nav__link">
    Advanced Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    Exceptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-retrieval-with-a-cookie" class="md-nav__link">
    Code retrieval with a cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-expiration-hook" class="md-nav__link">
    Token expiration hook
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      Public API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Public API" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Public API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/spotify_api_client/" class="md-nav__link">
      Spotify Api Client
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/authentification/" class="md-nav__link">
      Authentification
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/token_renew_class/" class="md-nav__link">
      Token Renew Hook
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/spotify_errors/" class="md-nav__link">
      Spotify Errors
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5" >
    
    <label class="md-nav__link" for="nav-3-5">
      Endpoints
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Endpoints" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        <span class="md-nav__icon md-icon"></span>
        Endpoints
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/albums/" class="md-nav__link">
      Albums
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/artists/" class="md-nav__link">
      Artists
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/browse/" class="md-nav__link">
      Browse
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/episodes/" class="md-nav__link">
      Episodes
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/follow/" class="md-nav__link">
      Follow
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/library/" class="md-nav__link">
      Library
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/personalization/" class="md-nav__link">
      Personalization
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/player/" class="md-nav__link">
      Player
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/playlists/" class="md-nav__link">
      Playlists
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/search/" class="md-nav__link">
      Search
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/shows/" class="md-nav__link">
      Shows
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/tracks/" class="md-nav__link">
      Tracks
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../public_api/endpoints/user/" class="md-nav__link">
      User
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    
    <label class="md-nav__link" for="nav-4">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../reference/error_message/" class="md-nav__link">
      Error Message
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../reference/request_handler/" class="md-nav__link">
      Request Handler
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../reference/status_classes/" class="md-nav__link">
      Status Classes
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../reference/url/" class="md-nav__link">
      URLS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../STUFF/" class="md-nav__link">
      Tests
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../LICENCE/" class="md-nav__link">
      Licence
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav" aria-label="Getting started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorization-code-flow" class="md-nav__link">
    Authorization Code Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-flow" class="md-nav__link">
    Client Credentials Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints" class="md-nav__link">
    Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" class="md-nav__link">
    Advanced Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    Exceptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-retrieval-with-a-cookie" class="md-nav__link">
    Code retrieval with a cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-expiration-hook" class="md-nav__link">
    Token expiration hook
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/HuiiBuh/AsyncSpotify/edit/master/docs/EXAMPLES.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h1>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>If you want to start connecting to the spotify api you have to create a new instance of one of the AuthorizationCodeFlows. Currently onle the <code>AuthorizationCodeFlow</code> and <code>ClientCredentialsFlow</code> are supported. These AuthorizationCodeFlow hold all sorts of configurations.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">async_spotify.authentification.authorization_flows</span> <span class="kn">import</span> <span class="n">AuthorizationCodeFlow</span>

<span class="n">auth_flow</span> <span class="o">=</span> <span class="n">AuthorizationCodeFlow</span><span class="p">(</span>
    <span class="n">application_id</span> <span class="o">=</span> <span class="s1">&#39;Your id&#39;</span><span class="p">,</span>
    <span class="n">application_secret</span> <span class="o">=</span> <span class="s1">&#39;Your secret&#39;</span><span class="p">,</span>
    <span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;your&#39;</span><span class="p">,</span> <span class="s1">&#39;scopes&#39;</span><span class="p">],</span>
    <span class="n">redirect_url</span> <span class="o">=</span> <span class="s1">&#39;your.redirect.url&#39;</span><span class="p">)</span>

<span class="c1"># You can also load the auth_code_flow from environment variables.</span>
<span class="c1"># If the variable does not exist the existing value will not be overwritten.</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>
</code></pre></div>
<p>These created auth_flow have to be passed to the <code>SpotifyApiClient</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create new client</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">)</span>
</code></pre></div>
<h3 id="authorization-code-flow">Authorization Code Flow<a class="headerlink" href="#authorization-code-flow" title="Permanent link">&para;</a></h3>
<p>To get a code from Spotify the user has to agree to the scopes your app asks for.<br />
For this you create an authorization, let the user visit this url and read the code parameter in the spotify redirect.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Build the authorization url for the users</span>
<span class="n">authorization_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">build_authorization_url</span><span class="p">(</span><span class="n">show_dialog</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>If you have some questions about this process read <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow">this</a> spotify article about it.</p>
<p>We will assume that you managed to get a code from spotify for a specific user.</p>
<p>Now we have to exchange the code for an authorization token, and a refresh token.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Exchange the code for the tokens</span>
<span class="n">auth_token</span><span class="p">:</span> <span class="n">SpotifyAuthorisationToken</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_auth_token_with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</code></pre></div>
<p>After we recieved the <code>auth_token</code> we can start making request.
But before we make this we have to create a new client which will be internally used for all the request making.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new client which will handle the request</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>

<span class="c1"># Get information about an album</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">,</span> <span class="n">market</span><span class="o">=</span><span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want to shut down your application and don't want to leak requests you have to call the <code>close_client</code> method of the <code>api_client</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Close the client</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
</div>
<h3 id="client-credentials-flow">Client Credentials Flow<a class="headerlink" href="#client-credentials-flow" title="Permanent link">&para;</a></h3>
<p>In this case you only have to pass your auth_flow to your <code>SpotifyApiClient</code> and call the <code>get_auth_token_with_client_credentials</code> method.</p>
<p>If you have some questions about this process read <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/#client-credentials-flow">this</a> potify article about it.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a auth flow (this time a ClientCredentialsFlow)</span>
<span class="n">auth_flow</span> <span class="o">=</span> <span class="n">ClientCredentialsFlow</span><span class="p">()</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>

<span class="c1"># Pass it to the spotify client</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">)</span>

<span class="c1"># Get the token from spotify</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_auth_token_with_client_credentials</span><span class="p">()</span>
<span class="c1"># And start making requests</span>
<span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>
</code></pre></div>
<p>After we recieved the <code>auth_token</code> we can start making request.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new client which will handle the request</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>

<span class="c1"># Get information about an album</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">,</span> <span class="n">market</span><span class="o">=</span><span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want to shut down your application and don't want to leak requests you have to call the <code>close_client</code> method of the <code>api_client</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Close the client</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
</div>
<h2 id="endpoints">Endpoints<a class="headerlink" href="#endpoints" title="Permanent link">&para;</a></h2>
<p>Every Api Endpoint is represented as an instance variables of the <code>SpotifyApiClient</code>.<br />
Look <a href="https://huiibuh.github.io/AsyncSpotify/public_api/spotify_api_client/">here</a> for every instance variable and the associated classes.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># For the albums endpoint</span>
<span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">whatever</span><span class="p">()</span>
<span class="c1"># For the artist endpoint</span>
<span class="n">api_client</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">whatever</span><span class="p">()</span>
</code></pre></div>
<h2 id="advanced-configuration">Advanced Configuration<a class="headerlink" href="#advanced-configuration" title="Permanent link">&para;</a></h2>
<p>If you don't want to pass the <code>auth_token</code> every time you make a request you can instruct the <code>SpotifyApiClient</code> to keep the token in memory.
Every time you refresh the token the in memory token will be updated too.
So you always have a valid token you can make requests with.
If the token expires you will still have to refresh it yourself by calling the <code>refresh_token</code> method, which will returned the updated token.
You don't have to pass a token to the method however if you want the internal token to be updated.<br />
In addition to that you can limit the simultaneous requests, and the timout if you create a new client.</p>
<div class="highlight"><pre><span></span><code><span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># And if you already have a auth_token you can pass this token to the constructor</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># Make the requests without passing the auth_token every time</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>

<span class="c1"># Limit the requests and the timeout</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">(</span><span class="n">request_limit</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">request_timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</code></pre></div>
<h2 id="exceptions">Exceptions<a class="headerlink" href="#exceptions" title="Permanent link">&para;</a></h2>
<p>There are multiple exception which could get raised by the <code>SpotifyApiClient</code>.<br />
Every exception inherits from the <code>SpotifyBaseError</code> so if you want to catch every spotify exception you can do it with the <code>SpotifyBaseError</code>.</p>
<ul>
<li>The <code>SpotifyError</code> exception gets raised for general usage errors</li>
<li>The <code>TokenExpired</code> exception gets raised if the spotify token used for making an api call is expired</li>
<li>The <code>RateLimitExceeded</code> exception gets raised if the rate limit is exceeded</li>
<li>The <code>SpotifyAPIError</code> exception gets raised for general errors like a invalid album id</li>
</ul>
<p>Each of the exceptions implements the <code>get_json()</code> method which will return the following json:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The status is the HTTP status code and if not aplicable the number 0.
The message is the reason something failed.</p>
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="p">:</span>
    <span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>
<span class="k">except</span> <span class="n">SpotifyAPIError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
    <span class="c1"># Do something with the error message</span>
</code></pre></div>
<h2 id="code-retrieval-with-a-cookie">Code retrieval with a cookie<a class="headerlink" href="#code-retrieval-with-a-cookie" title="Permanent link">&para;</a></h2>
<p>Normally you have to get the code with the client credential workflow. If your user has already agreed to the scopes, and you have the cookie of the user you can get rid of this process.<br />
This is mostly intended for testing purposes, but you could also use it in your production environment in the very unlikely edge case that you have the spotify cookie of your user.</p>
<p>You start like normal and create a new <code>SpotifyApiClient</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">auth_flow</span> <span class="o">=</span> <span class="n">AuthorizationCodeFlow</span><span class="p">()</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>

<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a new spotify cookie</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="n">SpotifyCookie</span><span class="p">()</span>
<span class="c1"># Load the cookie from a file (you can also use the constructor to pass the data)</span>
<span class="n">cookies</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="s1">&#39;Path/to/cookie.json&#39;</span><span class="p">)</span>

<span class="c1"># Get the coke with the spotify cookie</span>
<span class="n">code</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_code_with_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>

<span class="c1"># Use the retrieved code to get the auth token</span>
<span class="n">auth_token</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_auth_token_with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>

<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
<p>Format of the <em>cookie.json</em></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;sp_t&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
  <span class="nt">&quot;sp_dc&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
  <span class="nt">&quot;sp_key&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="token-expiration-hook">Token expiration hook<a class="headerlink" href="#token-expiration-hook" title="Permanent link">&para;</a></h2>
<p>If you want to add a hook in case your auth token expires you can pass an instance of your <code>TokenRenewClass</code> to the <code>SpotifyApiClient</code>.<br />
Your <code>TokenRenewClass</code> has to implement an <code>async call</code> method which has the <code>SpotifyApiClient</code> as parameter and returns an updated and valid <code>SpotifyAuthorisationToken</code>.
As long as you respect this interface you can do what you want (update a token in your database, ...).</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">YourTokenRenewClass</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Renew the auth token every time it expires</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spotify_api_client</span><span class="p">:</span> <span class="n">SpotifyApiClient</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpotifyAuthorisationToken</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Async method which gets called if the token is expired</span>

<span class="sd">        Args:</span>
<span class="sd">            spotify_api_client: The instance of the SpotifyApiClient</span>

<span class="sd">        Returns: A renewed spotify authorization token</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="k">await</span> <span class="n">spotify_api_client</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>

<span class="n">renew_class</span> <span class="o">=</span> <span class="n">YourTokenRenewClass</span><span class="p">()</span>

<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">token_renew_instance</span> <span class="o">=</span> <span class="n">renew_class</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<p>If you don't want to implement a class for your own and don't want to save the updated auth token to your database you can use the included <a href="../public_api/token_renew_class/"><code>TokenRenewClass</code></a>.<br />
Because <code>hold_authentication</code> is set to <code>True</code> the SpotifyApiClient will save the renewed token in memory and use it to make request.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">async_spotify</span> <span class="kn">import</span> <span class="n">SpotifyApiClient</span><span class="p">,</span> <span class="n">TokenRenewClass</span>

<span class="n">renew_token</span> <span class="o">=</span> <span class="n">TokenRenewClass</span><span class="p">()</span>
<span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">renew_token</span><span class="p">)</span>
</code></pre></div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 28, 2020</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </div>
            </div>
          </a>
        
        
          <a href="../public_api/spotify_api_client/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Spotify Api Client
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/huiibuh" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['instant'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>